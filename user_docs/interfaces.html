<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="de">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Benutzung der Schnittstellen &#8212; DeepGreen 1.0.1 Dokumentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="author" title="Über dieses Dokument" href="../about.html" />
    <link rel="index" title="Stichwortverzeichnis" href="../genindex.html" />
    <link rel="search" title="Suche" href="../search.html" />
    <link rel="next" title="Anleitung und Hinweise für Verlage" href="publisher.html" />
    <link rel="prev" title="Einleitung" href="intro.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Stichwortverzeichnis"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="publisher.html" title="Anleitung und Hinweise für Verlage"
             accesskey="N">weiter</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Einleitung"
             accesskey="P">zurück</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DeepGreen 1.0.1 Dokumentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Anleitung zur Benutzung von DeepGreen</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/deepgreen_logo.svg" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Inhalt</a></h3>
  <ul>
<li><a class="reference internal" href="#">Benutzung der Schnittstellen</a><ul>
<li><a class="reference internal" href="#web-api">Web-API</a><ul>
<li><a class="reference internal" href="#datenannahme">Datenannahme</a><ul>
<li><a class="reference internal" href="#nur-metadaten-beispiel-validation">Nur Metadaten (Beispiel <code class="docutils literal"><span class="pre">validation</span></code>)</a></li>
<li><a class="reference internal" href="#metadaten-und-paket-beispiel-notification">Metadaten und Paket (Beispiel <code class="docutils literal"><span class="pre">notification</span></code>)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datenabgabe">Datenabgabe</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sword">SWORD</a></li>
<li><a class="reference internal" href="#sftp">sFTP</a></li>
<li><a class="reference internal" href="#oai-pmh">OAI-PMH</a></li>
</ul>
</li>
</ul>

  <h4>Vorheriges Thema</h4>
  <p class="topless"><a href="intro.html"
                        title="vorheriges Kapitel">Einleitung</a></p>
  <h4>Nächstes Thema</h4>
  <p class="topless"><a href="publisher.html"
                        title="nächstes Kapitel">Anleitung und Hinweise für Verlage</a></p>
  <div role="note" aria-label="source link">
    <h3>Diese Seite</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/user_docs/interfaces.rst.txt"
            rel="nofollow">Quellcode anzeigen</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Schnellsuche</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Los" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="benutzung-der-schnittstellen">
<h1>Benutzung der Schnittstellen<a class="headerlink" href="#benutzung-der-schnittstellen" title="Link zu dieser Überschrift">¶</a></h1>
<p>Im folgenden werden die in DeepGreen realisierten Schnittstellen <code class="docutils literal"><span class="pre">REST</span> <span class="pre">Web-API</span></code>,
<code class="docutils literal"><span class="pre">SWORDv2</span></code>, <code class="docutils literal"><span class="pre">sFTP</span></code> und <code class="docutils literal"><span class="pre">OAI-PMH</span></code> zur Datenannahme bzw. -abgabe genauer erklärt.</p>
<div class="section" id="web-api">
<h2>Web-API<a class="headerlink" href="#web-api" title="Link zu dieser Überschrift">¶</a></h2>
<p>DeepGreen bietet eine (<em>rudimentäre?</em>)
<a class="reference external" href="https://de.wikipedia.org/wiki/Representational_State_Transfer">REST-Schnittstelle</a> an.
Die aktuelle Version der DeepGreen REST API ist <code class="docutils literal"><span class="pre">v1</span></code>. Diese kann über die Web-Adresse
<code class="docutils literal"><span class="pre">https://oa-deepgreen.kobv.de/api/v1</span></code> angesprochen werden, z.B. mit dem Kommando
<a class="reference external" href="https://curl.haxx.se">curl</a> in einer Shell (<code class="docutils literal"><span class="pre">bash</span></code>, <code class="docutils literal"><span class="pre">tcsh</span></code>, etc.):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ curl -k -s <span class="o">[</span>-X GET<span class="p">|</span>POST<span class="p">|</span>PUT<span class="p">|</span>HEADER<span class="o">]</span> https://oa-deepgreen.kobv.de/api/v1/...
</pre></div>
</div>
<p>Dabei werden in den nun nachfolgende Beispielen die <code class="docutils literal"><span class="pre">...</span></code> ersetzt durch die konkreten
REST-Resourcen <code class="docutils literal"><span class="pre">validate</span></code>, <code class="docutils literal"><span class="pre">notification</span></code> und <code class="docutils literal"><span class="pre">routed</span></code> der Web-API-Schnittstelle.</p>
<div class="section" id="datenannahme">
<h3>Datenannahme<a class="headerlink" href="#datenannahme" title="Link zu dieser Überschrift">¶</a></h3>
<p>Vor der Übertragung eines Datenpakets einer Publikation zu DeepGreen kann das Paket von
der Datendrehscheibe überprüft werden. Es sind also zwei REST-Resourcen des Web-APIs verfügbar,</p>
<ol class="arabic simple">
<li>Validierung eines Datenpakets (<code class="docutils literal"><span class="pre">validation</span></code>),</li>
<li>Übertragung eines Datenpakets (<code class="docutils literal"><span class="pre">notification</span></code>).</li>
</ol>
<p>Für ganz ungeduldige Leser hier zwei (funktionierende!) <code class="docutils literal"><span class="pre">bash</span></code>-Beispielskripte, die
<code class="docutils literal"><span class="pre">zip</span></code>-Pakete mit einem <code class="docutils literal"><span class="pre">api_key</span></code> an DeepGreen liefert bzw. validiert.  Die Skripte
analysieren zunächst jeweils die angegeben <code class="docutils literal"><span class="pre">zip</span></code>-Datei, welches Metadatenschema im
Datenpaket vorliegt.  Momentan werden von DeepGreen drei Schemata verarbeitet, <code class="docutils literal"><span class="pre">DTD</span> <span class="pre">JATS</span></code>,
<code class="docutils literal"><span class="pre">DTD</span> <span class="pre">Journal</span></code> (dies ist eine Variante des <code class="docutils literal"><span class="pre">DTD</span> <span class="pre">JATS</span></code>-Schema) und <code class="docutils literal"><span class="pre">DTD</span> <span class="pre">RSC</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">bash-Skript zur Validierung</span><a class="headerlink" href="#id1" title="Link zu diesem Quellcode">¶</a></div>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env bash</span>

<span class="nv">host_url</span><span class="o">=</span><span class="s2">&quot;https://oa-deepgreen.kobv.de&quot;</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -ge <span class="m">2</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nv">api_key</span><span class="o">=</span><span class="nv">$1</span>
  <span class="nv">zip_file</span><span class="o">=</span><span class="nv">$2</span>
<span class="k">else</span>
  <span class="nb">echo</span> <span class="s2">&quot;usage: `basename </span><span class="nv">$0</span><span class="s2">` {api-key} {zip-file}&quot;</span>
  <span class="nb">exit</span> -1
<span class="k">fi</span>

<span class="nv">curl</span><span class="o">=</span><span class="sb">`</span>which curl<span class="sb">`</span>
<span class="nv">zipgrep</span><span class="o">=</span><span class="sb">`</span>which zipgrep<span class="sb">`</span>
<span class="nv">wc</span><span class="o">=</span><span class="sb">`</span>which wc<span class="sb">`</span>

<span class="nv">pkg_fmt</span><span class="o">=</span><span class="s2">&quot;https://datahub.deepgreen.org/FilesAndJATS&quot;</span>
<span class="nv">has_xml</span><span class="o">=</span><span class="sb">`</span><span class="si">${</span><span class="nv">zipgrep</span><span class="si">}</span> <span class="s2">&quot;DOCTYPE article&quot;</span> <span class="si">${</span><span class="nv">zip_file</span><span class="si">}</span> <span class="p">|</span> <span class="si">${</span><span class="nv">wc</span><span class="si">}</span> -l<span class="sb">`</span>

<span class="k">if</span> <span class="o">[</span> <span class="si">${</span><span class="nv">has_xml</span><span class="si">}</span> -eq <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nv">is_jrnl</span><span class="o">=</span><span class="sb">`</span><span class="si">${</span><span class="nv">zipgrep</span><span class="si">}</span> <span class="s2">&quot;//NLM//DTD Journal &quot;</span> <span class="si">${</span><span class="nv">zip_file</span><span class="si">}</span> <span class="p">|</span> <span class="si">${</span><span class="nv">wc</span><span class="si">}</span> -l<span class="sb">`</span>
  <span class="nv">is_jats</span><span class="o">=</span><span class="sb">`</span><span class="si">${</span><span class="nv">zipgrep</span><span class="si">}</span> <span class="s2">&quot;//NLM//DTD JATS &quot;</span> <span class="si">${</span><span class="nv">zip_file</span><span class="si">}</span> <span class="p">|</span> <span class="si">${</span><span class="nv">wc</span><span class="si">}</span> -l<span class="sb">`</span>
  <span class="nv">is_rsc</span><span class="o">=</span><span class="sb">`</span><span class="si">${</span><span class="nv">zipgrep</span><span class="si">}</span> <span class="s2">&quot;//RSC//DTD RSC &quot;</span> <span class="si">${</span><span class="nv">zip_file</span><span class="si">}</span> <span class="p">|</span> <span class="si">${</span><span class="nv">wc</span><span class="si">}</span> -l<span class="sb">`</span>
  <span class="k">if</span> <span class="o">[</span> <span class="si">${</span><span class="nv">is_jrnl</span><span class="si">}</span> -eq <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">pkg_fmt</span><span class="o">=</span><span class="s2">&quot;https://datahub.deepgreen.org/FilesAndJATS&quot;</span>
  <span class="k">elif</span> <span class="o">[</span> <span class="si">${</span><span class="nv">is_jats</span><span class="si">}</span> -eq <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">pkg_fmt</span><span class="o">=</span><span class="s2">&quot;https://datahub.deepgreen.org/FilesAndJATS&quot;</span>
  <span class="k">elif</span> <span class="o">[</span> <span class="si">${</span><span class="nv">is_rsc</span><span class="si">}</span> -eq <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">pkg_fmt</span><span class="o">=</span><span class="s2">&quot;https://datahub.deepgreen.org/FilesAndRSC&quot;</span>
  <span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&quot;error: no valid .xml (JATS or RSC) in zip archive found: stop.&quot;</span>
    <span class="nb">exit</span> -2
  <span class="k">fi</span>
<span class="k">else</span>
  <span class="nb">echo</span> <span class="s2">&quot;error: no valid (or too many?!) .xml (JATS xor RSC) in zip archive found: stop.&quot;</span>
  <span class="nb">exit</span> -3
<span class="k">fi</span>

<span class="nb">echo</span> <span class="s2">&quot;`basename </span><span class="nv">$0</span><span class="s2">`: packaging format in zip archive found:&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;`basename </span><span class="nv">$0</span><span class="s2">`: </span><span class="si">${</span><span class="nv">pkg_fmt</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="si">${</span><span class="nv">curl</span><span class="si">}</span> -i -k -s -XPOST <span class="s2">&quot;</span><span class="si">${</span><span class="nv">host_url</span><span class="si">}</span><span class="s2">/api/v1/validate?api_key=</span><span class="si">${</span><span class="nv">api_key</span><span class="si">}</span><span class="s2">&quot;</span> -F <span class="s2">&quot;content=@</span><span class="si">${</span><span class="nv">zip_file</span><span class="si">}</span><span class="s2">;type=application/zip&quot;</span> -F <span class="s2">&quot;metadata=@-;type=application/json&quot;</span> <span class="s">&lt;&lt;EOF</span>
<span class="s">{</span>
<span class="s">  &quot;content&quot; : {</span>
<span class="s">     &quot;packaging_format&quot; : &quot;${pkg_fmt}&quot;</span>
<span class="s">  }</span>
<span class="s">}</span>
<span class="s">EOF</span>

<span class="nb">echo</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">bash-Skript zur Datenpaketübertragung</span><a class="headerlink" href="#id2" title="Link zu diesem Quellcode">¶</a></div>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env bash</span>

<span class="nv">host_url</span><span class="o">=</span><span class="s2">&quot;https://oa-deepgreen.kobv.de&quot;</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -ge <span class="m">2</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nv">api_key</span><span class="o">=</span><span class="nv">$1</span>
  <span class="nv">zip_file</span><span class="o">=</span><span class="nv">$2</span>
<span class="k">else</span>
  <span class="nb">echo</span> <span class="s2">&quot;usage: `basename </span><span class="nv">$0</span><span class="s2">` {api-key} {zip-file}&quot;</span>
  <span class="nb">exit</span> -1
<span class="k">fi</span>

<span class="nv">curl</span><span class="o">=</span><span class="sb">`</span>which curl<span class="sb">`</span>
<span class="nv">zipgrep</span><span class="o">=</span><span class="sb">`</span>which zipgrep<span class="sb">`</span>
<span class="nv">wc</span><span class="o">=</span><span class="sb">`</span>which wc<span class="sb">`</span>

<span class="nv">pkg_fmt</span><span class="o">=</span><span class="s2">&quot;https://datahub.deepgreen.org/FilesAndJATS&quot;</span>
<span class="nv">has_xml</span><span class="o">=</span><span class="sb">`</span><span class="si">${</span><span class="nv">zipgrep</span><span class="si">}</span> <span class="s2">&quot;DOCTYPE article&quot;</span> <span class="si">${</span><span class="nv">zip_file</span><span class="si">}</span> <span class="p">|</span> <span class="si">${</span><span class="nv">wc</span><span class="si">}</span> -l<span class="sb">`</span>

<span class="k">if</span> <span class="o">[</span> <span class="si">${</span><span class="nv">has_xml</span><span class="si">}</span> -eq <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nv">is_jrnl</span><span class="o">=</span><span class="sb">`</span><span class="si">${</span><span class="nv">zipgrep</span><span class="si">}</span> <span class="s2">&quot;//NLM//DTD Journal &quot;</span> <span class="si">${</span><span class="nv">zip_file</span><span class="si">}</span> <span class="p">|</span> <span class="si">${</span><span class="nv">wc</span><span class="si">}</span> -l<span class="sb">`</span>
  <span class="nv">is_jats</span><span class="o">=</span><span class="sb">`</span><span class="si">${</span><span class="nv">zipgrep</span><span class="si">}</span> <span class="s2">&quot;//NLM//DTD JATS &quot;</span> <span class="si">${</span><span class="nv">zip_file</span><span class="si">}</span> <span class="p">|</span> <span class="si">${</span><span class="nv">wc</span><span class="si">}</span> -l<span class="sb">`</span>
  <span class="nv">is_rsc</span><span class="o">=</span><span class="sb">`</span><span class="si">${</span><span class="nv">zipgrep</span><span class="si">}</span> <span class="s2">&quot;//RSC//DTD RSC &quot;</span> <span class="si">${</span><span class="nv">zip_file</span><span class="si">}</span> <span class="p">|</span> <span class="si">${</span><span class="nv">wc</span><span class="si">}</span> -l<span class="sb">`</span>
  <span class="k">if</span> <span class="o">[</span> <span class="si">${</span><span class="nv">is_jrnl</span><span class="si">}</span> -eq <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">pkg_fmt</span><span class="o">=</span><span class="s2">&quot;https://datahub.deepgreen.org/FilesAndJATS&quot;</span>
  <span class="k">elif</span> <span class="o">[</span> <span class="si">${</span><span class="nv">is_jats</span><span class="si">}</span> -eq <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">pkg_fmt</span><span class="o">=</span><span class="s2">&quot;https://datahub.deepgreen.org/FilesAndJATS&quot;</span>
  <span class="k">elif</span> <span class="o">[</span> <span class="si">${</span><span class="nv">is_rsc</span><span class="si">}</span> -eq <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">pkg_fmt</span><span class="o">=</span><span class="s2">&quot;https://datahub.deepgreen.org/FilesAndRSC&quot;</span>
  <span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&quot;error: no valid .xml (JATS or RSC) in zip archive found: stop.&quot;</span>
    <span class="nb">exit</span> -2
  <span class="k">fi</span>
<span class="k">else</span>
  <span class="nb">echo</span> <span class="s2">&quot;error: no valid (or too many?!) .xml (JATS xor RSC) in zip archive found: stop.&quot;</span>
  <span class="nb">exit</span> -3
<span class="k">fi</span>

<span class="nb">echo</span> <span class="s2">&quot;`basename </span><span class="nv">$0</span><span class="s2">`: packaging format in zip archive found:&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;`basename </span><span class="nv">$0</span><span class="s2">`: </span><span class="si">${</span><span class="nv">pkg_fmt</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="si">${</span><span class="nv">curl</span><span class="si">}</span> -i -k -s -XPOST <span class="s2">&quot;</span><span class="si">${</span><span class="nv">host_url</span><span class="si">}</span><span class="s2">/api/v1/notification?api_key=</span><span class="si">${</span><span class="nv">api_key</span><span class="si">}</span><span class="s2">&quot;</span> -F <span class="s2">&quot;content=@</span><span class="si">${</span><span class="nv">zip_file</span><span class="si">}</span><span class="s2">;type=application/zip&quot;</span> -F <span class="s2">&quot;metadata=@-;type=application/json&quot;</span> <span class="s">&lt;&lt;EOF</span>
<span class="s">{</span>
<span class="s">    &quot;content&quot; : {</span>
<span class="s">        &quot;packaging_format&quot; : &quot;${pkg_fmt}&quot;</span>
<span class="s">    }</span>
<span class="s">}</span>
<span class="s">EOF</span>

<span class="nb">echo</span>
</pre></div>
</div>
</div>
<div class="section" id="nur-metadaten-beispiel-validation">
<h4>Nur Metadaten (Beispiel <code class="docutils literal"><span class="pre">validation</span></code>)<a class="headerlink" href="#nur-metadaten-beispiel-validation" title="Link zu dieser Überschrift">¶</a></h4>
<p>Für die Verifikation einer Datenlieferung macht es durchaus Sinn, nur die Metadaten der
Lieferung zu schicken.  Dazu wird das <code class="docutils literal"><span class="pre">json</span></code>-Format &#8220;<code class="docutils literal"><span class="pre">Incoming</span> <span class="pre">Notification</span> <span class="pre">JSON</span></code>&#8221;
zur Beschreibung der zu überprüfenden Metadaten verwendet.  Mit Binärdaten gebündelte
Lieferungen können natürlich ebenso geprüft werden.  Dies funktioniert genau wie im
Beispiel <code class="docutils literal"><span class="pre">notification</span></code> unten angegeben.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Angabe von Metadaten durch &#8220;<code class="docutils literal"><span class="pre">Incoming</span> <span class="pre">Notification</span> <span class="pre">JSON</span></code>&#8221; (internes DeepGreen-Format)</span><a class="headerlink" href="#id3" title="Link zu diesem Quellcode">¶</a></div>
<div class="highlight-rest"><div class="highlight"><pre><span></span>POST /validate?api_key=&lt;api_key&gt;
Content-Type: application/json

[Incoming Notification JSON]
</pre></div>
</div>
</div>
<ul>
<li><p class="first"><strong>http-Header Rückgabewerte</strong></p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Code</th>
<th class="head">Beschreibung</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"></p>
<p class="last"><strong>204</strong> No Content</p>
</td>
<td><p class="first"></p>
<p class="last">Datenpaket ok!</p>
</td>
</tr>
<tr class="row-odd"><td><p class="first"></p>
<p class="last"><strong>400</strong> Bad Request</p>
</td>
<td><div class="first last highlight-rest"><div class="highlight"><pre><span></span>HTTP 1.1  400 Bad Request
Content-Type: application/json

{
  &quot;error&quot; : &quot;&lt;verständliche(?) Fehlermeldung (auf englisch)&gt;&quot;
}
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p class="first"></p>
<p class="last"><strong>401</strong> Unauthorised</p>
</td>
<td><p class="first"></p>
<p class="last">z.B. ungültiger <code class="docutils literal"><span class="pre">api_key</span></code>, falsche Benutzertyp</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="metadaten-und-paket-beispiel-notification">
<h4>Metadaten und Paket (Beispiel <code class="docutils literal"><span class="pre">notification</span></code>)<a class="headerlink" href="#metadaten-und-paket-beispiel-notification" title="Link zu dieser Überschrift">¶</a></h4>
<p>Artikellieferungen, die binären Inhalt enthalten sollen (z.B. der Volltext als <code class="docutils literal"><span class="pre">pdf</span></code>),
werden durch die Kennzeichnung &#8220;<code class="docutils literal"><span class="pre">multipart/form-data</span></code>&#8221; im http-Header gebündelt.  Dabei
<strong>muss</strong> im <code class="docutils literal"><span class="pre">json</span></code> des Metadatenteil (&#8220;<code class="docutils literal"><span class="pre">Incoming</span> <span class="pre">Notifikation</span> <span class="pre">JSON</span></code>&#8221;) das Feld
<strong>content.packaging_format</strong> zwingend vorhanden sein.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">http-POST: Bündelung durch &#8220;<code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">multipart/form-data;</span> <span class="pre">...</span></code>&#8220;</span><a class="headerlink" href="#id4" title="Link zu diesem Quellcode">¶</a></div>
<div class="highlight-rest"><div class="highlight"><pre><span></span>POST /notification?api_key=&lt;api_key&gt;
Content-Type: multipart/form-data; boundary=FulltextBoundary

--FulltextBoundary

Content-Disposition: form-data; name=&quot;metadata&quot;
Content-Type: application/json

[Incoming Notification JSON]

--FulltextBoundary

Content-Disposition: form-data; name=&quot;content&quot;
Content-Type: application/zip

[Package]

--FulltextBoundary--
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Minimale Angabe der Metadaten durch &#8220;<code class="docutils literal"><span class="pre">packaging_format</span></code>&#8220;</span><a class="headerlink" href="#id5" title="Link zu diesem Quellcode">¶</a></div>
<div class="highlight-rest"><div class="highlight"><pre><span></span>POST /notification?api_key=&lt;api_key&gt;
Content-Type: multipart/form-data; boundary=FulltextBoundary

--FulltextBoundary

Content-Disposition: form-data; name=&quot;metadata&quot;
Content-Type: application/json

{
    &quot;content&quot; : {
        &quot;packaging_format&quot; : &quot;https://datahub.deepgreen.org/FilesAndJATS&quot;
    }
}

--FulltextBoundary

Content-Disposition: form-data; name=&quot;content&quot;
Content-Type: application/zip

[Package]

--FulltextBoundary--
</pre></div>
</div>
</div>
<ul>
<li><p class="first"><strong>http-Header Rückgabewerte</strong></p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Code</th>
<th class="head">Beschreibung</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><p class="first"></p>
<p class="last"><strong>202</strong> Accepted</p>
</td>
<td><div class="first last highlight-rest"><div class="highlight"><pre><span></span>HTTP 1.1  202 Accepted
Content-Type: application/json
Location: &lt;URL des api-Endpunkts der akzeptierten Lieferung&gt;

{
  &quot;status&quot; : &quot;accepted&quot;,
  &quot;id&quot; : &quot;&lt;eindeutige ID dieser neuen Notifikation&gt;&quot;,
  &quot;location&quot; : &quot;&lt;URL des api-Endpunkts dieser Notifikation&gt;&quot;
}
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p class="first"></p>
<p class="last"><strong>400</strong> Bad Request</p>
</td>
<td><div class="first last highlight-rest"><div class="highlight"><pre><span></span>HTTP 1.1  400 Bad Request
Content-Type: application/json

{
  &quot;error&quot; : &quot;&lt;verständliche(?) Fehlermeldung (auf englisch)&gt;&quot;
}
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><p class="first"></p>
<p class="last"><strong>401</strong> Unauthorised</p>
</td>
<td><p class="first"></p>
<p class="last">z.B. ungültiger <code class="docutils literal"><span class="pre">api_key</span></code>, falscher Benutzertyp</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="datenabgabe">
<h3>Datenabgabe<a class="headerlink" href="#datenabgabe" title="Link zu dieser Überschrift">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Liste aller erfolgreich zugestellten Notifikationen</span><a class="headerlink" href="#id6" title="Link zu diesem Quellcode">¶</a></div>
<div class="highlight-rest"><div class="highlight"><pre><span></span>GET /routed[?&lt;params&gt;]
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Liste der zugestellten Notifikationen <strong>einer</strong> Einrichtung</span><a class="headerlink" href="#id7" title="Link zu diesem Quellcode">¶</a></div>
<div class="highlight-rest"><div class="highlight"><pre><span></span>GET /routed/&lt;repo_id&gt;[?&lt;params&gt;]
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Eine bestimmte Notification, geliefert im Format &#8220;<code class="docutils literal"><span class="pre">Outgoing</span> <span class="pre">Notification</span> <span class="pre">JSON</span></code>&#8221; (internes DeepGreen-Format)</span><a class="headerlink" href="#id8" title="Link zu diesem Quellcode">¶</a></div>
<div class="highlight-rest"><div class="highlight"><pre><span></span>GET /notification/&lt;notification_id&gt;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sword">
<h2>SWORD<a class="headerlink" href="#sword" title="Link zu dieser Überschrift">¶</a></h2>
</div>
<div class="section" id="sftp">
<h2>sFTP<a class="headerlink" href="#sftp" title="Link zu dieser Überschrift">¶</a></h2>
</div>
<div class="section" id="oai-pmh">
<h2>OAI-PMH<a class="headerlink" href="#oai-pmh" title="Link zu dieser Überschrift">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Stichwortverzeichnis"
             >Index</a></li>
        <li class="right" >
          <a href="publisher.html" title="Anleitung und Hinweise für Verlage"
             >weiter</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Einleitung"
             >zurück</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DeepGreen 1.0.1 Dokumentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Anleitung zur Benutzung von DeepGreen</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2017, DeepGreen Konsortium.
      Mit <a href="http://sphinx-doc.org/">Sphinx</a> 1.5 erstellt.
    </div>
  </body>
</html>